<div *ngIf="isSessionSelected">
  <app-session-result-details [sessionHistory]="selectedSessionHistory"
    (go_back)="navigateBack()"></app-session-result-details>
</div>

<section *ngIf="getQuiz().id !== -1 && !isSessionSelected">
  <header class="header">
    <button class="back-button" (click)="goBack()">Retour</button>
    <div class="quiz-info">
      <h1>Statistiques Quiz</h1>
      <p class="quiz-title">{{ getQuiz().title }}</p>
    </div>
  </header>

  <h2 class="section-title">Général</h2>
  <section class="global-metrics">
    <div class="card">
      <h3>{{ totalPlays }}</h3>
      <p>Parties jouées</p>
    </div>
    <div class="card">
      <h3>{{ averageTime }}s</h3>
      <p>Temps moyen</p>
    </div>
    <div class="card">
      <h3>{{ averageHints }}</h3>
      <p>Nombre d'indices moyens</p>
    </div>
    <div class="card">
      <h3>{{ averageAttempts }}</h3>
      <p>Nombre d'essais moyens</p>
    </div>
  </section>

  <h2 class="section-title">Questions</h2>

  <section class="content">
    <!-- Liste cliquable à gauche -->
    <aside class="question-list">
      <div class="question-card" *ngFor="let q of questionsStats; let i = index" [class.active]="i === selectedIndex"
        (click)="selectQuestion(i)">

        <div class="question-text">{{ q.text }}</div>

        <div class="question-stats">
          <span>Temps moyen : {{ q.avgTime }}s</span>
          <span>Indices moyen : {{ q.hintsUsed }}</span>
        </div>

      </div>
    </aside>

    <!-- Graphique groupé à droite -->
    <main class="chart-area">
      <h2>{{ questionsStats[selectedIndex].text }}</h2>
      <canvas #groupChart></canvas>
    </main>
  </section>
  <app-quiz-session-history [quizId]="getQuiz().id" [quizTitle]="getQuiz().title" [sessionHistory]="getSessionHistory()"
    (viewDetailsEvent)="viewSessionDetails($event)"></app-quiz-session-history>
</section>



<section *ngIf="getQuiz().id == -1 || null">
  <span>SOMETHING WENT WRONG</span>
  <span>Try Again</span>
</section>